/*! 
  author: tcly861204
  email: tcly861204@hotmail.com
  date: 2022/1/7 上午11:17:18
  gitee: https://gitee.com/tcly861204/vite-react-cnode
 */
var K=Object.defineProperty,U=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var I=(l,e,t)=>e in l?K(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,T=(l,e)=>{for(var t in e||(e={}))G.call(e,t)&&I(l,t,e[t]);if(j)for(var t of j(e))Q.call(e,t)&&I(l,t,e[t]);return l},z=(l,e)=>U(l,Y(e));import{P as m,R as n,r as a,a as V}from"./vendor.99c5d277.js";const Z=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const y of u.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&c(y)}).observe(document,{childList:!0,subtree:!0});function t(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function c(o){if(o.ep)return;o.ep=!0;const u=t(o);fetch(o.href,u)}};Z();const O=l=>{const{value:e,callback:t}=l;return n.createElement("label",{className:["cui_checkbox",e&&"is-checked"].join(" ")},n.createElement("span",{onClick:c=>{t&&typeof t=="function"&&t(),c.preventDefault()},className:["cui_checkbox__input",e&&"is-checked"].join(" ")},n.createElement("span",{className:"cui_checkbox__inner"}),n.createElement("input",{type:"checkbox","aria-hidden":"false",className:"cui_checkbox__original"})))};O.propTypes={value:m.bool,callback:m.func};const M=function(){return document.addEventListener?function(l,e,t){l&&e&&t&&l.addEventListener(e,t,!1)}:function(l,e,t){l&&e&&t&&l.attachEvent("on"+e,t)}}(),W=function(){return document.removeEventListener?function(l,e,t){l&&e&&l.removeEventListener(e,t,!1)}:function(l,e,t){l&&e&&l.detachEvent("on"+e,t)}}();function X(l){const{columns:e,callback:t,handleSelected:c}=l,o=a.exports.useRef(null),[u,y]=a.exports.useState(!1);a.exports.useEffect(()=>{let s=null,d=null,r=null,E=null,g=null,p=null;const h=function(i){s=i.clientX,g=i.target.parentNode.parentNode.parentNode.parentNode,E=JSON.parse(JSON.stringify(g.getBoundingClientRect())),p=document.createElement("div"),p.className="resize-line",g.appendChild(p),M(document,"mousemove",v),M(document,"mouseup",S)},v=function(i){p.style.left=`${i.clientX-E.left-2}px`,d=i.clientX},S=function(){W(r.target,"mousedown",h),W(document,"mousemove",v),W(document,"mouseup",S),p.parentNode.removeChild(p);const i=r.target.dataset.field;t(i,r.target.offsetWidth+1+(d-s))},k=function(i){i.target.nodeName.toLocaleLowerCase()==="li"&&i.offsetX>8&&i.target.className.includes("__resize")?(i.target.style.cursor="col-resize",r=i,M(i.target,"mousedown",h)):(i.target.nodeName.toLocaleLowerCase()==="li"||i.target.nodeName.toLocaleLowerCase()==="div")&&(i.target.style.cursor="default")};return M(o.current,"mousemove",k),()=>{W(o.current,"mousemove",k)}},[o]);const $=a.exports.useCallback(()=>{y(s=>(s=!s,c&&typeof c=="function"&&c(s),s))},[u,c]);return n.createElement("div",{className:"table-header",ref:o},e.map((s,d)=>{const r=s.width,E={width:`${r}px`,maxWidth:`${r}px`,minWidth:`${r}px`,padding:"0 8px",boxSizing:"border-box"};return n.createElement("li",{className:[`align-${s.headerAlign||s.align||"left"}`,s.resizable&&"__resize"].join(" "),"data-field":s.prop||null,style:s.width?E:{flex:1,padding:"0 8px",boxSizing:"border-box"},key:d},n.createElement("div",null,s.type==="selection"?n.createElement(O,{value:u,callback:$}):s.label))}))}X.propTypes={columns:m.array,callback:m.func,handleSelected:m.func};var B=n.memo(X);function A(l){const{data:e,scrollTop:t,maxRow:c,columns:o,deleteCallback:u}=l,y=e.length>15?15:e.length,$=function(d,r){if(d.component&&d.type!=="delete")return n.createElement(d.component,{index:r});if(d.prop)return n.createElement("div",{className:"cell line-clamp"},e[r][d.prop]);switch(d.type){case"index":return n.createElement("div",{className:"cell"},r+1);case"selection":return n.createElement("div",{className:"cell"},n.createElement(O,{value:e[r]._checked||!1}));case"delete":return d.component?n.createElement(d.component,{index:r,callback:u}):null;default:return null}},s=function(){const d=[];let r=0;const E="cui-bigdata-container",g=e.length;g>c?t<g-c-4?r=t+c+3:r=g:r=e.length;for(let p=t;p<r;p++)d.push(n.createElement("div",{key:p,className:`${E}-row`,style:{transform:`translateY(${p*36}px)`}},o.map((h,v)=>n.createElement("li",{key:v,className:`align-${h.align||"left"}`,style:h.width?{width:`${h.width-1}px`,maxWidth:`${h.width-1}px`,minWidth:`${h.width-1}px`}:{display:1}},$(h,p)))));return d};return n.createElement("div",{className:"table-body",style:{height:`${y*36}px`}},s())}A.propTypes={data:m.array.isRequired,scrollTop:m.number.isRequired,maxRow:m.number.isRequired,columns:m.array,deleteCallback:m.func};const q=l=>{const{data:e,handleSelected:t}=l,c=a.exports.useRef(null),[o,u]=a.exports.useState(l.columns||[]),[y,$]=a.exports.useState(8),[s,d]=a.exports.useState(0),[r,E]=a.exports.useState(0),[g,p]=a.exports.useState([]),[h,v]=a.exports.useState([]),[S,k]=a.exports.useState([]),[i]=a.exports.useState(l.rowHeight||36),[w]=a.exports.useState(l.maxRow||15),[F,P]=a.exports.useState(!1);a.exports.useEffect(()=>{p(o.filter(f=>f.fixed==="left")),v(o.filter(f=>f.fixed==="right")),k(o.filter(f=>!["left","right"].includes(f.fixed)))},[o]),a.exports.useEffect(()=>{const f=setTimeout(()=>{const x=c.current.clientWidth,N=c.current.parentNode.clientWidth;return $(N-x),()=>{clearTimeout(f)}},30)},[e,c]),a.exports.useEffect(()=>{P(e.length>w)},[e,w]);const D=a.exports.useCallback(function(f,x){if(!f)return;const N=o.findIndex(R=>R.prop===f);if(N>=0){const R=[...o];R[N].width=x<20?20:x,u(R)}},[o]),b="cui-bigdata-container",C=a.exports.useMemo(()=>g.reduce((f,x)=>f+(x.width||100),0),[g]),_=a.exports.useMemo(()=>h.reduce((f,x)=>f+(x.width||100),0),[h]),H=((e.length>w?w:e.length)+1)*i,J=function(f){const x=f.currentTarget.scrollTop,N=f.currentTarget.scrollLeft;x!==s&&d(Math.floor(x/i)),N!==r&&E(N)},L=e.length*i;return n.createElement("section",{className:b,style:{height:`${H+2}px`}},n.createElement("section",{className:`${b}-header`},n.createElement("div",{className:`${b}_left`,style:{width:`${C}px`}},n.createElement(B,{columns:g,callback:D,handleSelected:t})),n.createElement("div",{className:`${b}_content`,style:{left:`${C-r}px`,right:`${_+(F?y:0)-r}px`}},n.createElement(B,{handleSelected:t,columns:S,callback:D})),n.createElement("div",{className:`${b}_right`,style:{width:`${_+(F?y:0)}px`,right:0}},n.createElement(B,{columns:h,callback:D}))),n.createElement("section",{className:`${b}-body`,style:{height:`${H-36}px`},onScroll:J,ref:c},n.createElement("div",{className:`${b}_left`,style:{width:`${C}px`,left:`${r}px`,height:`${L}px`}},n.createElement(A,z(T({},l),{maxRow:w,scrollTop:s,columns:g}))),n.createElement("div",{className:`${b}_content`,style:{left:`${C}px`,right:`${_-r}px`,height:`${L}px`}},n.createElement(A,z(T({},l),{maxRow:w,scrollTop:s,columns:S}))),n.createElement("div",{className:`${b}_right`,style:{width:`${_}px`,right:`${0-r}px`,height:`${L}px`}},n.createElement(A,z(T({},l),{maxRow:w,scrollTop:s,columns:h}))),n.createElement("div",{className:`${b}_scroll`,style:{height:`${L}px`}})))};q.propTypes={data:m.array,handleSelected:m.func,columns:m.array,rowHeight:m.number,maxRow:m.number};class ee extends a.exports.Component{constructor(e){super(e);this.state={columns:[{type:"selection",align:"center",fixed:"left",width:50},{label:"\u5E8F\u53F7",type:"index",fixed:"left",headerAlign:"center",align:"center",width:60},{label:"\u6807\u9898",prop:"title",fixed:"left",width:180,resizable:!0},{label:"\u59D3\u540D",prop:"name",width:120,resizable:!0},{label:"\u5730\u533A",prop:"region",width:100},{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:150,resizable:!0},{label:"\u59D3\u522B",prop:"sex",width:140,resizable:!0},{label:"\u64CD\u4F5C",headerAlign:"center",type:"delete",width:56,resizable:!1,fixed:"right",component:t=>{const{index:c,callback:o}=t;return n.createElement("div",{onClick:()=>{o&&typeof o=="function"&&o(c)},style:{textAlign:"center",fontSize:"13px",cursor:"pointer",color:"#409eff"}},"\u5220\u9664")}}],data:[]}}componentDidMount(){fetch("/vite-react-hooks-bigdata/public/data.json").then(e=>e.json()).then(e=>{e.msg==="OK"&&this.setState({data:e.data.list})})}render(){const{columns:e,data:t}=this.state;return n.createElement("section",{style:{padding:"50px"}},n.createElement(q,{columns:e,data:t,deleteCallback:c=>{t.splice(c,1),this.setState({data:t})},handleSelected:c=>{this.setState({data:t.map(o=>(o._checked=c,o))})}}))}}V.render(n.createElement(n.StrictMode,null,n.createElement(ee,null)),document.getElementById("root"));
